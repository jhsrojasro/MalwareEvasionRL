from reinforce import ReinforceAgent
import numpy as np
import gymnasium as gym
import sys
sys.path.append("..")
from utils.graphs import plot_metrics

env = gym.make("CartPole-v1")

agent = ReinforceAgent(env, input_dims = (env.observation_space.shape[0],), n_actions = env.action_space.n, nn_hidden_units = 64, nn_hidden_layers=1)
# states, actions, rewards, next_states, dones = agent.play_episode()
states, actions, rewards, dones, next_states = agent.collect_trajectories(10)
states_values = []
next_states_values = []
for i in range(len(states)):
    states_values.append(agent.valueFunction(states[i]).detach())
    next_states_values.append(agent.valueFunction(next_states[i]).detach())
# print(rewards)
rewards_to_go = agent.rewards_to_go(rewards)
agent.train(100, batch_size=64, verbose=False)