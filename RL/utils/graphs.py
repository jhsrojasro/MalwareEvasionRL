import matplotlib.pyplot as plt
import numpy as np


def plot_metrics(metrics, title="Trained Agent Metrics"):
    fig, axs = plt.subplots(2, 3, figsize=(15, 10))
    n = np.arange(1, len(metrics)+1)
    axs[0, 0].plot(n, metrics[:, 0])
    axs[0, 0].set_title("Mean Reward")
    axs[0, 0].set_xlabel ("Episode")
    axs[0, 1].plot(n, metrics[:, 1])
    axs[0, 1].set_title("Std Reward")
    axs[0, 1].set_xlabel ("Episode")
    axs[0, 2].plot(n, metrics[:, 2])
    axs[0, 2].set_title("Median Reward")
    axs[0, 2].set_xlabel ("Episode")
    axs[1, 0].plot(n, metrics[:, 3])
    axs[1, 0].set_title("Min Reward")
    axs[1, 0].set_xlabel ("Episode")
    axs[1, 1].plot(n, metrics[:, 4])
    axs[1, 1].set_title("Max Reward")
    axs[1, 1].set_xlabel ("Episode")
    axs[1, 2].plot(n, metrics[:, 5])
    axs[1, 2].set_title("Mean Steps")
    axs[1, 2].set_xlabel ("Episode")
    # plt.switch_backend('TkAgg')
    # plt.show()
    return fig

def plot_metrics_malware(metrics, title="Trained Agent Metrics"):
    fig, axs = plt.subplots(2, 3, figsize=(15, 10))
    axs[0, 0].plot(metrics[:, 0])
    axs[0, 0].set_title("Mean Reward")
    axs[0, 1].plot(metrics[:, 1])
    axs[0, 1].set_title("Std Reward")
    axs[0, 2].plot(metrics[:, 2])
    axs[0, 2].set_title("Median Reward")
    axs[1, 0].plot(metrics[:, 3])
    axs[1, 0].set_title("Min Reward")
    axs[1, 1].plot(metrics[:, 4])
    axs[1, 1].set_title("Max Reward")
    # plt.switch_backend('TkAgg')
    # plt.show()
    return fig

def plot_metrics_reinforce(metrics, title="Trained REINFORCE Agent Metrics"):
    fig, axs = plt.subplots(2, 3, figsize=(15, 10))
    n = len(metrics)
    axs[0, 0].plot(list(range(1,n+1)), metrics[:, 0])
    axs[0, 0].set_title("Evasion Percentage")
    axs[0, 1].plot(list(range(1,n+1)), metrics[:, 1])
    axs[0, 1].set_title("Mean Reward")
    axs[0, 2].plot(list(range(1,n+1)), metrics[:, 2])
    axs[0, 2].set_title("Std Reward")
    axs[1, 0].plot(list(range(1,n+1)), metrics[:, 3])
    axs[1, 0].set_title("Median Reward")
    axs[1, 1].plot(list(range(1,n+1)), metrics[:, 4])
    axs[1, 1].set_title("Max Reward")
    axs[1, 2].plot(list(range(1,n+1)), metrics[:, 5])
    axs[1, 2].set_title("Min Reward")
    return fig
