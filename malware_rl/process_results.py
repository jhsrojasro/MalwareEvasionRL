from malware_rl.envs.controls.modifier import ACTION_TABLE
# import gym
# import malware_rl
import pickle
from matplotlib import pyplot as plt


N = 100
dict_path = "data/evaded/ember/dqn_ember_100000_steps.p"
evasions_data = pickle.load( open( dict_path, "rb" ) )
n_evasions = len(evasions_data)
# print("Number of evasions: ", n_evasions)
# print("Percentage of evasions: ", n_evasions/N)
total_actions = []
for key , value in evasions_data.items():
    total_actions += value["actions"]
# print("Total actions: ", total_actions)
action_list = list(ACTION_TABLE.keys())
counts = [total_actions.count(action) / len(total_actions) for action in action_list]
plt.bar(action_list, counts)
plt.title("DQN Ember 100000 steps")
plt.xlabel("Actions")
plt.ylabel("Percentage")
plt.xticks(rotation='vertical')
plt.savefig("plots/bar_dqn_ember_100000_steps.png", bbox_inches="tight")
# print(evasions_data)

# print(ACTION_TABLE)