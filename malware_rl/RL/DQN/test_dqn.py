from dqn import DQNAgent
import gymnasium as gym
import sys
import numpy as np
sys.path.append("..")
from utils.graphs import plot_metrics

env = gym.make("CartPole-v0")
# env = gym.make("FrozenLake-v1")
# print((env.observation_space.n,))
agent = DQNAgent(env, nn_hidden_units = 256, nn_hidden_layers=2, memory_capacity = 50000, epsilon_decay=True, minibatch_size=32, verbose=True, checkpoint_path="models/test_cartpole.pt")
metrics = agent.train(100000, learning_rate=5e-4, initial_epsilon=1, final_epsilon=0.01)

fig = plot_metrics(metrics)

print(agent.test(100))